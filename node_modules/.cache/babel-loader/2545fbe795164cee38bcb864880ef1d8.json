{"remainingRequest":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/babel-loader/lib/index.js!/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/src/views/Player.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/src/views/Player.vue","mtime":1585639766764},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/cache-loader/dist/cjs.js","mtime":1584931130054},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/babel-loader/lib/index.js","mtime":1584931129970},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/cache-loader/dist/cjs.js","mtime":1584931130054},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/vue-loader/lib/index.js","mtime":1584931133236}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL01heGIvRGVza3RvcC9IVE1MNS9WdWVcdTVCNjZcdTRFNjAvZGF5LTAwNC9teVZ1ZUxlYXJuL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IE5vcm1hbFBsYXllciBmcm9tICIuLi9jb21wb25lbnRzL3BsYXllci9Ob3JtYWxQbGF5ZXIiOwppbXBvcnQgTWluaVBsYXllciBmcm9tICcuLi9jb21wb25lbnRzL3BsYXllci9NaW5pUGxheWVyJzsKaW1wb3J0IExpc3RQbGF5ZXIgZnJvbSAnLi4vY29tcG9uZW50cy9wbGF5ZXIvTGlzdFBsYXllcic7CmltcG9ydCB7IG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IG1vZGUgZnJvbSAnLi4vc3RvcmUvbW9kZVR5cGUnOwppbXBvcnQgeyBnZXRSYW5kb21JbnRJbmNsdXNpdmUgfSBmcm9tICcuLi90b29scy90b29sJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQbGF5ZXIiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB0b3RhbFRpbWU6IDAsCiAgICAgIGN1cnJlbnRUaW1lOiAwCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgTm9ybWFsUGxheWVyOiBOb3JtYWxQbGF5ZXIsCiAgICBNaW5pUGxheWVyOiBNaW5pUGxheWVyLAogICAgTGlzdFBsYXllcjogTGlzdFBsYXllcgogIH0sCiAgbWV0aG9kczogX29iamVjdFNwcmVhZCh7fSwgbWFwQWN0aW9ucyhbJ3NldEN1cnJlbnRJbmRleCcsICdzZXRGYXZvcml0ZUxpc3QnLCAnc2V0SGlzdG9yeVNvbmcnLCAnc2V0SGlzdG9yeUxpc3QnXSksIHsKICAgIHRpbWV1cGRhdGU6IGZ1bmN0aW9uIHRpbWV1cGRhdGUoZSkgewogICAgICB0aGlzLmN1cnJlbnRUaW1lID0gZS50YXJnZXQuY3VycmVudFRpbWU7CiAgICB9LAogICAgcGxheWVuZDogZnVuY3Rpb24gcGxheWVuZCgpIHsKICAgICAgaWYgKHRoaXMubW9kZVR5cGUgPT09IG1vZGUubG9vcCkgewogICAgICAgIHRoaXMuc2V0Q3VycmVudEluZGV4KHRoaXMuY3VycmVudEluZGV4ICsgMSk7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlVHlwZSA9PT0gbW9kZS5vbmUpIHsKICAgICAgICB0aGlzLiRyZWZzLmF1ZGlvLnBsYXkoKTsKICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGVUeXBlID09PSBtb2RlLnJhbmRvbSkgewogICAgICAgIHZhciBpbmRleCA9IGdldFJhbmRvbUludEluY2x1c2l2ZSgwLCB0aGlzLnNvbmdzLmxlbmd0aCAtIDEpOwogICAgICAgIHRoaXMuc2V0Q3VycmVudEluZGV4KGluZGV4KTsKICAgICAgfQogICAgfQogIH0pLAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKFsnY3VycmVudFNvbmcnLCAnaXNQbGF5aW5nJywgJ2N1cnJlbnRJbmRleCcsICdjdXJyZW50UGxheVRpbWUnLCAnbW9kZVR5cGUnLCAnc29uZ3MnLCAnZmF2b3JpdGVMaXN0JywgJ2hpc3RvcnlMaXN0J10pKSwKICB3YXRjaDogewogICAgaXNQbGF5aW5nOiBmdW5jdGlvbiBpc1BsYXlpbmcobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIGlmIChuZXdWYWx1ZSkgewogICAgICAgIHRoaXMuc2V0SGlzdG9yeVNvbmcodGhpcy5jdXJyZW50U29uZyk7CiAgICAgICAgdGhpcy4kcmVmcy5hdWRpby5wbGF5KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcmVmcy5hdWRpby5wYXVzZSgpOwogICAgICB9CiAgICB9LAogICAgY3VycmVudEluZGV4OiBmdW5jdGlvbiBjdXJyZW50SW5kZXgobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAvLyDlnKhpT1Pns7vnu5/kuK3vvIzkuI3kvJroh6rliqjliqDovb3mrYzmm7LvvIzmiYDku6VvbmNhbnBsYXnmsLjov5zpg73kuI3kvJrooqvmiafooYwsCiAgICAgIC8vIOS9huaYr+WcqHBj56uv5ZKMQW5kcmlvZOerr+WPr+S7peaJp+ihjO+8jOaJgOS7pemAmui/hwogICAgICB0aGlzLiRyZWZzLmF1ZGlvLm9uZHVyYXRpb25jaGFuZ2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMudG90YWxUaW1lID0gX3RoaXMuJHJlZnMuYXVkaW8uZHVyYXRpb247CgogICAgICAgIGlmIChfdGhpcy5pc1BsYXlpbmcpIHsKICAgICAgICAgIF90aGlzLnNldEhpc3RvcnlTb25nKF90aGlzLmN1cnJlbnRTb25nKTsKCiAgICAgICAgICBfdGhpcy4kcmVmcy5hdWRpby5wbGF5KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLiRyZWZzLmF1ZGlvLnBhdXNlKCk7CiAgICAgICAgfQogICAgICB9OwogICAgfSwKICAgIGN1cnJlbnRQbGF5VGltZTogZnVuY3Rpb24gY3VycmVudFBsYXlUaW1lKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICB0aGlzLiRyZWZzLmF1ZGlvLmN1cnJlbnRUaW1lID0gbmV3VmFsdWU7CiAgICB9LAogICAgZmF2b3JpdGVMaXN0OiBmdW5jdGlvbiBmYXZvcml0ZUxpc3QobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmF2b3JpdGVMaXN0JywgSlNPTi5zdHJpbmdpZnkobmV3VmFsdWUpKTsKICAgIH0sCiAgICBoaXN0b3J5TGlzdDogZnVuY3Rpb24gaGlzdG9yeUxpc3QobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaGlzdG9yeUxpc3QnLCBKU09OLnN0cmluZ2lmeShuZXdWYWx1ZSkpOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBsaXN0ID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Zhdm9yaXRlTGlzdCcpKTsKCiAgICBpZiAobGlzdCA9PT0gbnVsbCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5zZXRGYXZvcml0ZUxpc3QobGlzdCk7CiAgICB2YXIgaGlzdG9yeWxpc3QgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaGlzdG9yeUxpc3QnKSk7CgogICAgaWYgKGxpc3QgPT09IG51bGwpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRoaXMuc2V0SGlzdG9yeUxpc3QoaGlzdG9yeWxpc3QpOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHRoaXMuJHJlZnMuYXVkaW8ub25kdXJhdGlvbmNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMyLnRvdGFsVGltZSA9IF90aGlzMi4kcmVmcy5hdWRpby5kdXJhdGlvbjsKICAgIH07CiAgfQp9Ow=="},{"version":3,"sources":["Player.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"player\">\n    <NormalPlayer :totalTime=\"totalTime\" :currentTime=\"currentTime\"></NormalPlayer>\n    <MiniPlayer></MiniPlayer>\n    <ListPlayer ref=\"listPlayer\"></ListPlayer>\n    <audio :src=\"currentSong.url\" ref=\"audio\" @timeupdate=\"timeupdate\" @ended=\"playend\"></audio>\n  </div>\n</template>\n\n<script>\nimport NormalPlayer from \"../components/player/NormalPlayer\"\nimport MiniPlayer from '../components/player/MiniPlayer'\nimport ListPlayer from '../components/player/ListPlayer'\nimport { mapGetters, mapActions } from 'vuex'\nimport mode from '../store/modeType'\nimport { getRandomIntInclusive } from '../tools/tool'\n\nexport default {\n  name: \"Player\",\n  data() {\n    return {\n      totalTime: 0,\n      currentTime: 0\n    }\n  },\n  components: {\n    NormalPlayer,\n    MiniPlayer,\n    ListPlayer\n  },\n  methods: {\n    ...mapActions([\n      'setCurrentIndex',\n      'setFavoriteList',\n      'setHistorySong',\n      'setHistoryList'\n    ]),\n\n    timeupdate (e) {\n      this.currentTime = e.target.currentTime\n    },\n\n    playend () {\n      if (this.modeType === mode.loop) {\n        this.setCurrentIndex(this.currentIndex + 1)\n      }else if (this.modeType === mode.one) {\n        this.$refs.audio.play()\n      }else if (this.modeType === mode.random) {\n        let index = getRandomIntInclusive(0, this.songs.length - 1)\n        this.setCurrentIndex(index)\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'currentSong',\n      'isPlaying',\n      'currentIndex',\n      'currentPlayTime',\n      'modeType',\n      'songs',\n      'favoriteList',\n      'historyList'\n    ])\n  },\n\n  watch: {\n    isPlaying(newValue, oldValue) {\n      if (newValue) {\n        this.setHistorySong(this.currentSong)\n        this.$refs.audio.play()\n      }else {\n        this.$refs.audio.pause()\n      }\n    },\n\n    currentIndex(newValue, oldValue) {\n      // 在iOS系统中，不会自动加载歌曲，所以oncanplay永远都不会被执行,\n      // 但是在pc端和Andriod端可以执行，所以通过\n      this.$refs.audio.ondurationchange = () => {\n        this.totalTime = this.$refs.audio.duration\n        if (this.isPlaying) {\n          this.setHistorySong(this.currentSong)\n          this.$refs.audio.play()\n        }else {\n          this.$refs.audio.pause()\n        }\n      }\n    },\n\n    currentPlayTime (newValue, oldValue) {\n      this.$refs.audio.currentTime = newValue\n    },\n\n    favoriteList(newValue, oldValue) {\n      window.localStorage.setItem('favoriteList', JSON.stringify(newValue))\n    },\n\n    historyList(newValue, oldValue) {\n      window.localStorage.setItem('historyList', JSON.stringify(newValue))\n    },\n  },\n\n  created() {\n    let list = JSON.parse(window.localStorage.getItem('favoriteList'))\n    if (list === null) {\n      return\n    }\n    this.setFavoriteList(list)\n\n    let historylist = JSON.parse(window.localStorage.getItem('historyList'))\n    if (list === null) {\n      return\n    }\n    this.setHistoryList(historylist)\n  },\n\n  mounted() {\n    this.$refs.audio.ondurationchange = () => {\n      this.totalTime = this.$refs.audio.duration\n    }\n  },\n\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n"],"sourceRoot":"src/views"}]}