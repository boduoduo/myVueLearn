{"remainingRequest":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/src/views/Search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/src/views/Search.vue","mtime":1587367340097},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/cache-loader/dist/cjs.js","mtime":1584931130054},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/babel-loader/lib/index.js","mtime":1584931129970},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/cache-loader/dist/cjs.js","mtime":1584931130054},{"path":"/Users/Maxb/Desktop/HTML5/Vue学习/day-004/myVueLearn/node_modules/vue-loader/lib/index.js","mtime":1584931133236}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTY3JvbGxWaWV3IGZyb20gIi4uL2NvbXBvbmVudHMvU2Nyb2xsVmlldyI7CmltcG9ydCB7IGdldFNlYXJjaExpc3QsIGdldFNlYXJjaEhvdCB9IGZyb20gIi4uL2FwaS9pbmRleCI7CmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4JwppbXBvcnQgeyBnZXRMb2NhbFN0b3JhZ2UsIHNldExvY2FsU3RvcmFnZSB9IGZyb20gIi4uL3Rvb2xzL3Rvb2wiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJTZWFyY2giLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBrZXl3b3JkczogIiIsCiAgICAgIHNvbmdzOiBbXSwKICAgICAgaG90czogW10sCiAgICAgIHNlYXJjaEhpc3Rvcnk6IFtdCiAgICB9OwogIH0sCgogIGNvbXBvbmVudHM6IHsKICAgIFNjcm9sbFZpZXcKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBnZXRTZWFyY2hIb3QoKQogICAgLnRoZW4oKHJlcykgPT4gewogICAgICB0aGlzLmhvdHMgPSByZXMucmVzdWx0LmhvdHMKICAgIH0pCiAgICAuY2F0Y2goKGVycikgPT4gewogICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICB9KQogICAgaWYgKGdldExvY2FsU3RvcmFnZSgnc2VhcmNoSGlzdG9yeScpICE9IHVuZGVmaW5lZCAmJiBnZXRMb2NhbFN0b3JhZ2UoJ3NlYXJjaEhpc3RvcnknKSAhPSBudWxsKSB7CiAgICAgIHRoaXMuc2VhcmNoSGlzdG9yeSA9IGdldExvY2FsU3RvcmFnZSgnc2VhcmNoSGlzdG9yeScpCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKFsnc2V0RnVsbFNjcmVlbicsICdzZXRTb25nRGV0YWlsJ10pLAogICAgc2VhcmNoKCkgewogICAgICBpZiAodGhpcy5rZXl3b3JkcyA9PT0gIiIpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZ2V0U2VhcmNoTGlzdCh7ICdrZXl3b3Jkcyc6IHRoaXMua2V5d29yZHMgfSkKICAgICAgICAudGhlbihkYXRhID0+IHsKICAgICAgICAgIHRoaXMuc29uZ3MgPSBkYXRhLnJlc3VsdC5zb25nczsKICAgICAgICB9KQogICAgICAgIC50aGVuKGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIH0pOwogICAgfSwKICAgIHNlbGVjdE11c2ljIChpZCkgewogICAgICB0aGlzLnNldEZ1bGxTY3JlZW4odHJ1ZSkKICAgICAgdGhpcy5zZXRTb25nRGV0YWlsKFtpZF0pCgogICAgICBpZiAodGhpcy5zZWFyY2hIaXN0b3J5LmluY2x1ZGVzKHRoaXMua2V5d29yZHMpKSB7CiAgICAgICAgcmV0dXJuCiAgICAgIH0KICAgICAgdGhpcy5zZWFyY2hIaXN0b3J5LnB1c2godGhpcy5rZXl3b3JkcykKICAgICAgc2V0TG9jYWxTdG9yYWdlKCdzZWFyY2hIaXN0b3J5JywgdGhpcy5zZWFyY2hIaXN0b3J5KQogICAgICB0aGlzLmtleXdvcmRzID0gJycKICAgIH0sCiAgICBzZWFyY2hIb3RJdGVtKHZhbHVlKSB7CiAgICAgIHRoaXMua2V5d29yZHMgPSB2YWx1ZQogICAgICB0aGlzLnNlYXJjaCgpCiAgICB9LAogICAgZGVsZXRlSGlzdG9yeVNvbmcobmFtZSkgewogICAgICB0aGlzLnNlYXJjaEhpc3RvcnkgPSB0aGlzLnNlYXJjaEhpc3RvcnkuZmlsdGVyKChpdGVtKSA9PiB7CiAgICAgICAgcmV0dXJuIGl0ZW0gIT0gbmFtZQogICAgICB9KQogICAgICBzZXRMb2NhbFN0b3JhZ2UoJ3NlYXJjaEhpc3RvcnknLCB0aGlzLnNlYXJjaEhpc3RvcnkpCiAgICB9CiAgfSwKCiAgLy8g6Ieq5a6a5LmJ5oyH5LukCiAgZGlyZWN0aXZlczogewogICAgdGhyb3R0bGU6IHsKICAgICAgaW5zZXJ0ZWQ6IGZ1bmN0aW9uKGVsLCBvYmopIHsKICAgICAgICBsZXQgdGltZXJJZCA9IG51bGw7CiAgICAgICAgbGV0IGZsYWcgPSB0cnVlOwogICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoImlucHV0IiwgZnVuY3Rpb24oKSB7CiAgICAgICAgICBpZiAoIWZsYWcpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgZmxhZyA9IGZhbHNlOwogICAgICAgICAgdGltZXJJZCAmJiBjbGVhclRpbWVvdXQodGltZXJJZCk7CiAgICAgICAgICB0aW1lcklkID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIGZsYWcgPSB0cnVlOwogICAgICAgICAgICBvYmoudmFsdWUoKTsKICAgICAgICAgIH0sIDEwMDApOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Search.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"search\">\n    <div class=\"search-box\">\n      <img\n        src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNiAyNiI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsPSIjYzljOWNhIiBkPSJNMjUuMTgxIDIzLjUzNWwtMS40MTQgMS40MTQtNy4zMTUtNy4zMTRBOS45NjYgOS45NjYgMCAwIDEgMTAgMjBDNC40NzcgMjAgMCAxNS41MjMgMCAxMFM0LjQ3NyAwIDEwIDBzMTAgNC40NzcgMTAgMTBjMCAyLjM0Mi0uODExIDQuNDktMi4xNiA2LjE5NWw3LjM0MSA3LjM0ek0xMCAyYTggOCAwIDEgMCAwIDE2IDggOCAwIDAgMCAwLTE2eiIvPjwvc3ZnPg==\"\n        alt=\"\"\n      />\n      <input\n        type=\"text\"\n        placeholder=\"搜索歌曲、歌手、专辑\"\n        v-model=\"keywords\"\n        v-throttle=\"search\"\n      />\n    </div>\n    <div class=\"search-suggest\" v-show=\"keywords !== ''\">\n      <ScrollView>\n        <ul>\n          <li v-for=\"value in songs\" :key=\"value.id\" @click.stop=\"selectMusic(value.id)\">\n            <img\n              src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNiAyNiI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsPSIjYzljOWNhIiBkPSJNMjUuMTgxIDIzLjUzNWwtMS40MTQgMS40MTQtNy4zMTUtNy4zMTRBOS45NjYgOS45NjYgMCAwIDEgMTAgMjBDNC40NzcgMjAgMCAxNS41MjMgMCAxMFM0LjQ3NyAwIDEwIDBzMTAgNC40NzcgMTAgMTBjMCAyLjM0Mi0uODExIDQuNDktMi4xNiA2LjE5NWw3LjM0MSA3LjM0ek0xMCAyYTggOCAwIDEgMCAwIDE2IDggOCAwIDAgMCAwLTE2eiIvPjwvc3ZnPg==\"\n              alt=\"\"\n            />\n            <p>{{ value.name }} - {{ value.artists[0].name }}</p>\n          </li>\n        </ul>\n      </ScrollView>\n    </div>\n    <div class=\"search-hot\">\n      <h3>热门搜索</h3>\n      <ul>\n        <li v-for=\"(value, index) in hots\" :key=\"index\" @click.stop=\"searchHotItem(value.first)\">{{ value.first }}</li>\n      </ul>\n    </div>\n    <div class=\"search-history\">\n      <ul>\n        <li v-for=\"(value) in searchHistory\" :key=\"value\">\n          <div class=\"history-left\">\n            <img src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMCAzMCI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsPSIjYzljYWNhIiBkPSJNMTUgMzBDNi43MTYgMzAgMCAyMy4yODQgMCAxNVM2LjcxNiAwIDE1IDBzMTUgNi43MTYgMTUgMTUtNi43MTYgMTUtMTUgMTVtMC0yOEM3LjgyIDIgMiA3LjgyIDIgMTVzNS44MiAxMyAxMyAxMyAxMy01LjgyIDEzLTEzUzIyLjE4IDIgMTUgMm03IDE2aC04YTEgMSAwIDAgMS0xLTFWN2ExIDEgMCAxIDEgMiAwdjloN2ExIDEgMCAxIDEgMCAyIi8+PC9zdmc+\" alt=\"\">\n            <p>{{ value }}</p>\n          </div>\n          <div class=\"history-right\">\n            <img @click=\"deleteHistorySong(value)\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsPSIjOTk5ODk5IiBkPSJNMTMuMzc5IDEybDEwLjMzOCAxMC4zMzdhLjk3NS45NzUgMCAxIDEtMS4zNzggMS4zNzlMMTIuMDAxIDEzLjM3OCAxLjY2MyAyMy43MTZhLjk3NC45NzQgMCAxIDEtMS4zNzgtMS4zNzlMMTAuNjIzIDEyIC4yODUgMS42NjJBLjk3NC45NzQgMCAxIDEgMS42NjMuMjg0bDEwLjMzOCAxMC4zMzhMMjIuMzM5LjI4NGEuOTc0Ljk3NCAwIDEgMSAxLjM3OCAxLjM3OEwxMy4zNzkgMTIiLz48L3N2Zz4=\" alt=\"\">\n          </div>\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ScrollView from \"../components/ScrollView\";\nimport { getSearchList, getSearchHot } from \"../api/index\";\nimport { mapActions } from 'vuex'\nimport { getLocalStorage, setLocalStorage } from \"../tools/tool\";\n\nexport default {\n  name: \"Search\",\n  data() {\n    return {\n      keywords: \"\",\n      songs: [],\n      hots: [],\n      searchHistory: []\n    };\n  },\n\n  components: {\n    ScrollView\n  },\n  created() {\n    getSearchHot()\n    .then((res) => {\n      this.hots = res.result.hots\n    })\n    .catch((err) => {\n      console.log(err)\n    })\n    if (getLocalStorage('searchHistory') != undefined && getLocalStorage('searchHistory') != null) {\n      this.searchHistory = getLocalStorage('searchHistory')\n    }\n  },\n  methods: {\n    ...mapActions(['setFullScreen', 'setSongDetail']),\n    search() {\n      if (this.keywords === \"\") {\n        return;\n      }\n      getSearchList({ 'keywords': this.keywords })\n        .then(data => {\n          this.songs = data.result.songs;\n        })\n        .then(err => {\n          console.log(err);\n        });\n    },\n    selectMusic (id) {\n      this.setFullScreen(true)\n      this.setSongDetail([id])\n\n      if (this.searchHistory.includes(this.keywords)) {\n        return\n      }\n      this.searchHistory.push(this.keywords)\n      setLocalStorage('searchHistory', this.searchHistory)\n      this.keywords = ''\n    },\n    searchHotItem(value) {\n      this.keywords = value\n      this.search()\n    },\n    deleteHistorySong(name) {\n      this.searchHistory = this.searchHistory.filter((item) => {\n        return item != name\n      })\n      setLocalStorage('searchHistory', this.searchHistory)\n    }\n  },\n\n  // 自定义指令\n  directives: {\n    throttle: {\n      inserted: function(el, obj) {\n        let timerId = null;\n        let flag = true;\n        el.addEventListener(\"input\", function() {\n          if (!flag) {\n            return;\n          }\n          flag = false;\n          timerId && clearTimeout(timerId);\n          timerId = setTimeout(() => {\n            flag = true;\n            obj.value();\n          }, 1000);\n        });\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../assets/css/mixin\";\n@import \"../assets/css/variable\";\n.search {\n  position: fixed;\n  left: 0;\n  top: 184px;\n  bottom: 0;\n  right: 0;\n  @include bg_sub_color();\n  .search-box {\n    display: flex;\n    align-items: center;\n    margin: 40px 20px;\n    background-color: #ebecec;\n    border-radius: 30px;\n    img {\n      width: 40px;\n      height: 40px;\n      margin-left: 20px;\n    }\n    input {\n      border: none;\n      outline: none;\n      background: transparent;\n      @include font_size($font_medium);\n      height: 60px;\n      margin-left: 20px;\n    }\n  }\n  .search-suggest {\n    position: fixed;\n    left: 0;\n    top: 300px;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n    @include bg_sub_color();\n    li {\n      display: flex;\n      align-items: center;\n      padding: 20px;\n      box-sizing: border-box;\n      border-bottom: 1px solid #ccc;\n      img {\n        width: 40px;\n        height: 40px;\n      }\n      p {\n        margin-left: 20px;\n        @include font_color();\n        @include font_size($font_medium);\n      }\n    }\n  }\n  .search-hot {\n    h3 {\n      @include font_size($font_medium);\n      @include font_color();\n      padding: 10px 20px;\n    }\n    ul {\n      display: flex;\n      flex-wrap: wrap;\n      li {\n        height: 60px;\n        line-height: 60px;\n        border: 1px solid #000;\n        border-radius: 30px;\n        padding: 0 20px;\n        @include font_color();\n        @include font_size($font_medium_s);\n        margin: 10px 20px;\n      }\n    }\n  }\n  .search-history {\n    margin-top: 20px;\n    li {\n      padding: 20px 20px;\n      display: flex;\n      justify-content: space-between;\n      border-bottom: 1px solid #ccc;\n      .history-left {\n        display: flex;\n        align-items: center;\n        img {\n          width: 40px;\n          height: 40px;\n        }\n        p {\n          margin-left: 20px;\n          @include font_size($font_medium_s);\n          @include font_color();\n        }\n      }\n      .history-right {\n        img {\n          width: 30px;\n          height: 30px;\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}